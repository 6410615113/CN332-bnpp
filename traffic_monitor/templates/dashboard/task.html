{% extends "account/base_entrance.html" %}
{% load i18n %}
{% load allauth account %}
{% block head_title %}
    {% trans "Dashbord" %}
{% endblock head_title %}
{% block extra_head %}
    <link rel="stylesheet" type="text/css" href="/static/css/nav.css">
    <link rel="stylesheet" type="text/css" href="/static/css/dashboard.css">
{% endblock extra_head %}
{% block content %}
    <div class="nav">
        <h1>Traffic Monitor</h1>
        <div class="nav-item">
            <a href="{% url 'dashboard' %}" class="btn-nav">Dashboard</a>
            <a href="{% url 'profile' %}" class="btn-nav">Profile</a>
            <a href="{% url 'account_logout' %}" class="btn-logout">Logout</a>
        </div>
    </div>
    <div class="content">
        <h2>Process Task</h2>
        <div class="flex">
        <div style="border-right: 2px solid; padding: 20px;">
            <video id="video" height="360">
                <source src="/media/{{ video }}" type="video/mp4">
            </video> <br>
            <button class="playPause" onclick="playPause()">Play/Pause</button> 
            <script src="/static/js/getposition.js"></script>
        </div>
        <div class="new-task">
            <h2>Add New Loop</h2>
            <form action="{% url "view_task" task.id %}" method="post">
                {% csrf_token %}
                <table>
                    {{ formLoop.as_table }}
                    <tr>
                        <td></td>
                        <td><button type="submit" class="btn-submit">Add Loop</button></td>
                    </tr>
                </table>
            </form>
        </div>
        </div>
        <div>
            <h2>Loops</h2>
            <div class="dashboard">
                <table>
                    <tr>
                        <th rowspan="2">Loop ID</th>
                        <th rowspan="2">Start</th>
                        <th rowspan="2">End</th>
                        <th colspan="3">count</th>
                    </tr>
                    <tr>
                        <td>bike</td>
                        <td>car</td>
                        <td>truck</td>
                    </tr>
                    {% for loop in loops %}
                        <tr>
                            <td>{{ loop.id }}</td>
                            <td>({{ loop.start_x }}, {{loop.start_y}})</td>
                            <td>({{ loop.end_x }}, {{ loop.end_y }})</td>
                            <td>{{ loop.count_bike }}</td>
                            <td>{{ loop.count_car }}</td>
                            <td>{{ loop.count_truck }}</td>
                        </tr>
                    {% endfor %}
                </table>
            </div>
        </div>
    </div>
{% endblock content %}